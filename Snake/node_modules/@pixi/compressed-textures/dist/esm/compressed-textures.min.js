/*!
 * @pixi/compressed-textures - v6.0.0
 * Compiled Tue, 02 Mar 2021 21:45:03 UTC
 *
 * @pixi/compressed-textures is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
import{ViewableBuffer as _,BufferResource as R,BaseTexture as T,Texture as e}from"@pixi/core";import{LoaderResource as E}from"@pixi/loaders";import{MIPMAP_MODES as G,ALPHA_MODES as t,TYPES as O,FORMATS as A}from"@pixi/constants";var D,M;!function(_){_[_.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",_[_.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",_[_.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",_[_.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",_[_.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",_[_.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",_[_.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",_[_.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",_[_.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",_[_.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",_[_.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",_[_.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",_[_.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",_[_.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",_[_.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",_[_.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",_[_.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",_[_.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",_[_.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",_[_.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",_[_.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",_[_.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",_[_.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",_[_.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",_[_.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",_[_.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"}(M||(M={}));var S=((D={})[M.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,D[M.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,D[M.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,D[M.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,D[M.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,D[M.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,D[M.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,D[M.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,D[M.COMPRESSED_R11_EAC]=.5,D[M.COMPRESSED_SIGNED_R11_EAC]=.5,D[M.COMPRESSED_RG11_EAC]=1,D[M.COMPRESSED_SIGNED_RG11_EAC]=1,D[M.COMPRESSED_RGB8_ETC2]=.5,D[M.COMPRESSED_RGBA8_ETC2_EAC]=.5,D[M.COMPRESSED_SRGB8_ETC2]=.5,D[M.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=.5,D[M.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,D[M.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,D[M.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,D[M.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,D[M.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,D[M.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,D[M.COMPRESSED_RGB_ETC1_WEBGL]=.5,D[M.COMPRESSED_RGB_ATC_WEBGL]=.5,D[M.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,D[M.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,D),r=function(_,R){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,R){_.__proto__=R}||function(_,R){for(var T in R)R.hasOwnProperty(T)&&(_[T]=R[T])})(_,R)};function I(_,R){function T(){this.constructor=_}r(_,R),_.prototype=null===R?Object.create(R):(T.prototype=R.prototype,new T)}function n(_,R){var T,e,E,G,t={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return G={next:O(0),throw:O(1),return:O(2)},"function"==typeof Symbol&&(G[Symbol.iterator]=function(){return this}),G;function O(G){return function(O){return function(G){if(T)throw new TypeError("Generator is already executing.");for(;t;)try{if(T=1,e&&(E=2&G[0]?e.return:G[0]?e.throw||((E=e.return)&&E.call(e),0):e.next)&&!(E=E.call(e,G[1])).done)return E;switch(e=0,E&&(G=[2&G[0],E.value]),G[0]){case 0:case 1:E=G;break;case 4:return t.label++,{value:G[1],done:!1};case 5:t.label++,e=G[1],G=[0];continue;case 7:G=t.ops.pop(),t.trys.pop();continue;default:if(!(E=(E=t.trys).length>0&&E[E.length-1])&&(6===G[0]||2===G[0])){t=0;continue}if(3===G[0]&&(!E||G[1]>E[0]&&G[1]<E[3])){t.label=G[1];break}if(6===G[0]&&t.label<E[1]){t.label=E[1],E=G;break}if(E&&t.label<E[2]){t.label=E[2],t.ops.push(G);break}E[2]&&t.ops.pop(),t.trys.pop();continue}G=R.call(_,t)}catch(_){G=[6,_],e=0}finally{T=E=0}if(5&G[0])throw G[1];return{value:G[0]?G[1]:void 0,done:!0}}([G,O])}}}var X,o,F=function(R){function T(T,e){void 0===e&&(e={width:1,height:1,autoLoad:!0});var E,G,t=this;return"string"==typeof T?(E=T,G=new Uint8Array):(E=null,G=T),(t=R.call(this,G,e)||this).origin=E,t.buffer=G?new _(G):null,t.origin&&!1!==e.autoLoad&&t.load(),G&&G.length&&(t.loaded=!0,t.onBlobLoaded(t.buffer.rawBinaryData)),t}return I(T,R),T.prototype.onBlobLoaded=function(_){},T.prototype.load=function(){return R=this,T=void 0,e=Promise,E=function(){var R;return n(this,function(T){switch(T.label){case 0:return[4,fetch(this.origin)];case 1:return[4,T.sent().blob()];case 2:return[4,T.sent().arrayBuffer()];case 3:return R=T.sent(),this.data=new Uint32Array(R),this.buffer=new _(R),this.loaded=!0,this.onBlobLoaded(R),this.update(),[2,this]}})},new(e||(e=Promise))(function(_,G){function t(_){try{A(E.next(_))}catch(_){G(_)}}function O(_){try{A(E.throw(_))}catch(_){G(_)}}function A(R){R.done?_(R.value):new e(function(_){_(R.value)}).then(t,O)}A((E=E.apply(R,T||[])).next())});var R,T,e,E},T}(R),B=function(_){function R(T,e){var E=_.call(this,T,e)||this;return E.format=e.format,E.levels=e.levels||1,E._width=e.width,E._height=e.height,E._extension=R._formatToExtension(E.format),(e.levelBuffers||E.buffer)&&(E._levelBuffers=e.levelBuffers||R._createLevelBuffers(T instanceof Uint8Array?T:E.buffer.uint8View,E.format,E.levels,4,4,E.width,E.height)),E}return I(R,_),R.prototype.upload=function(_,R,T){var e=_.gl;if(!_.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var E=0,G=this.levels;E<G;E++){var t=this._levelBuffers[E],O=t.levelID,A=t.levelWidth,D=t.levelHeight,M=t.levelBuffer;e.compressedTexImage2D(e.TEXTURE_2D,O,this.format,A,D,0,M)}return!0},R.prototype.onBlobLoaded=function(){this._levelBuffers=R._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},R._formatToExtension=function(_){if(_>=33776&&_<=33779)return"s3tc";if(_>=37488&&_<=37497)return"etc";if(_>=35840&&_<=35843)return"pvrtc";if(_>=36196)return"etc1";if(_>=35986&&_<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},R._createLevelBuffers=function(_,R,T,e,E,G,t){for(var O=new Array(T),A=_.byteOffset,D=G,M=t,r=D+e-1&~(e-1),I=M+E-1&~(E-1),n=r*I*S[R],X=0;X<T;X++)O[X]={levelID:X,levelWidth:T>1?D:r,levelHeight:T>1?M:I,levelBuffer:new Uint8Array(_.buffer,A,n)},A+=n,n=(r=(D=D>>1||1)+e-1&~(e-1))*(I=(M=M>>1||1)+E-1&~(E-1))*S[R];return O},R}(F),a=function(){function _(){}return _.use=function(R,T){var e=R.data;if(_.textureExtensions||_.autoDetectExtensions(),R.type===E.TYPE.JSON&&e&&e.cacheID&&e.textures){for(var G=e.textures,t=void 0,O=void 0,A=0,D=G.length;A<D;A++){var M=G[A],S=M.src,r=M.format;if(r||(O=S),_.textureFormats[r]){t=S;break}}if(!(t=t||O))throw new Error("Cannot load compressed-textures in "+R.url+", make sure you provide a fallback");if(t===R.url)throw new Error("URL of compressed texture cannot be the same as the manifest's URL");var I={crossOrigin:R.crossOrigin,metadata:R.metadata.imageMetadata,parentResource:R};this.add(e.cacheID,t,I,function(){T()})}else T()},_.autoDetectExtensions=function(R){if(!R){var T=document.createElement("canvas").getContext("webgl");if(!T)return void console.error("WebGL not available for compressed textures. Silently failing.");R={s3tc:T.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:T.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:T.getExtension("WEBGL_compressed_texture_etc"),etc1:T.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:T.getExtension("WEBGL_compressed_texture_pvrtc")||T.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:T.getExtension("WEBGL_compressed_texture_atc"),astc:T.getExtension("WEBGL_compressed_texture_astc")}}for(var e in _.textureExtensions=R,_.textureFormats={},R){var E=R[e];E&&Object.assign(_.textureFormats,Object.getPrototypeOf(E))}},_}();function i(_,R){R&&R.forEach(function(R,E){var O=new T(R,{mipmap:G.OFF,alphaMode:t.NO_PREMULTIPLIED_ALPHA}),A=_+"-"+(E+1);T.addToCache(O,A),e.addToCache(new e(O),A),0===E&&(T.addToCache(O,_),e.addToCache(new e(O),_))})}E.setExtensionXhrType("dds",E.XHR_RESPONSE_TYPE.BUFFER);var P,C,s=3,N=4,u=7,f=19,U=2,L=0,l=1,c=2,d=3;!function(_){_[_.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",_[_.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",_[_.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",_[_.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",_[_.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",_[_.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",_[_.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",_[_.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",_[_.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",_[_.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",_[_.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",_[_.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",_[_.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",_[_.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",_[_.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",_[_.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",_[_.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",_[_.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",_[_.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",_[_.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",_[_.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",_[_.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",_[_.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",_[_.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",_[_.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",_[_.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",_[_.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",_[_.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",_[_.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",_[_.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",_[_.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",_[_.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",_[_.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",_[_.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",_[_.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",_[_.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",_[_.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",_[_.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",_[_.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",_[_.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",_[_.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",_[_.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",_[_.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",_[_.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",_[_.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",_[_.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",_[_.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",_[_.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",_[_.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",_[_.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",_[_.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",_[_.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",_[_.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",_[_.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",_[_.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",_[_.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",_[_.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",_[_.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",_[_.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",_[_.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",_[_.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",_[_.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",_[_.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",_[_.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",_[_.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",_[_.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",_[_.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",_[_.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",_[_.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",_[_.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",_[_.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",_[_.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",_[_.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",_[_.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",_[_.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",_[_.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",_[_.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",_[_.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",_[_.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",_[_.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",_[_.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",_[_.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",_[_.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",_[_.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",_[_.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",_[_.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",_[_.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",_[_.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",_[_.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",_[_.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",_[_.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",_[_.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",_[_.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",_[_.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",_[_.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",_[_.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",_[_.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",_[_.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",_[_.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",_[_.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",_[_.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",_[_.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",_[_.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",_[_.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",_[_.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",_[_.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",_[_.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",_[_.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",_[_.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",_[_.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",_[_.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",_[_.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",_[_.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",_[_.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",_[_.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",_[_.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",_[_.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",_[_.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",_[_.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",_[_.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",_[_.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",_[_.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"}(P||(P={})),function(_){_[_.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",_[_.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",_[_.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(C||(C={}));var h,p,v,w=((X={})[827611204]=M.COMPRESSED_RGBA_S3TC_DXT1_EXT,X[861165636]=M.COMPRESSED_RGBA_S3TC_DXT3_EXT,X[894720068]=M.COMPRESSED_RGBA_S3TC_DXT5_EXT,X),Y=((o={})[P.DXGI_FORMAT_BC1_TYPELESS]=M.COMPRESSED_RGBA_S3TC_DXT1_EXT,o[P.DXGI_FORMAT_BC1_UNORM]=M.COMPRESSED_RGBA_S3TC_DXT1_EXT,o[P.DXGI_FORMAT_BC2_TYPELESS]=M.COMPRESSED_RGBA_S3TC_DXT3_EXT,o[P.DXGI_FORMAT_BC2_UNORM]=M.COMPRESSED_RGBA_S3TC_DXT3_EXT,o[P.DXGI_FORMAT_BC3_TYPELESS]=M.COMPRESSED_RGBA_S3TC_DXT5_EXT,o[P.DXGI_FORMAT_BC3_UNORM]=M.COMPRESSED_RGBA_S3TC_DXT5_EXT,o[P.DXGI_FORMAT_BC1_UNORM_SRGB]=M.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,o[P.DXGI_FORMAT_BC2_UNORM_SRGB]=M.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,o[P.DXGI_FORMAT_BC3_UNORM_SRGB]=M.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,o),x=function(){function _(){}return _.use=function(R,T){"dds"===R.extension&&R.data&&i(R.name||R.url,_.parse(R.data)),T()},_.parse=function(_){var R=new Uint32Array(_);if(542327876!==R[0])throw new Error("Invalid DDS file magic word");var T=new Uint32Array(_,0,124/Uint32Array.BYTES_PER_ELEMENT),e=T[s],E=T[N],G=T[u],t=new Uint32Array(_,f*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),O=t[1];if(4&O){var A=t[U];if(808540228!==A){var D=w[A],M=new Uint8Array(_,128);return[new B(M,{format:D,width:E,height:e,levels:G})]}var r=new Uint32Array(R.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),I=r[L],n=r[l],X=r[c],o=r[d],F=Y[I];if(void 0===F)throw new Error("DDSLoader cannot parse texture data with DXGI format "+I);if(4===X)throw new Error("DDSLoader does not support cubemap textures");if(n===C.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var a=new Array;if(1===o)a.push(new Uint8Array(_,148));else{for(var i=S[F],P=0,h=E,p=e,v=0;v<G;v++){P+=Math.max(1,h+3&-4)*Math.max(1,p+3&-4)*i,h>>>=1,p>>>=1}var x=148;for(v=0;v<o;v++)a.push(new Uint8Array(_,x,P)),x+=P}return a.map(function(_){return new B(_,{format:F,width:E,height:e,levels:G})})}if(64&O)throw new Error("DDSLoader does not support uncompressed texture data.");if(512&O)throw new Error("DDSLoader does not supported YUV uncompressed texture data.");if(131072&O)throw new Error("DDSLoader does not support single-channel (lumninance) texture data!");if(2&O)throw new Error("DDSLoader does not support single-channel (alpha) texture data!");throw new Error("DDSLoader failed to load a texture file due to an unknown reason!")},_}();E.setExtensionXhrType("ktx",E.XHR_RESPONSE_TYPE.BUFFER);var H=[171,75,84,88,32,49,49,187,13,10,26,10],m=12,y=16,g=24,b=28,V=36,W=40,k=44,K=48,Q=52,j=56,J=60,q=((h={})[O.UNSIGNED_BYTE]=1,h[O.UNSIGNED_SHORT]=2,h[O.FLOAT]=4,h[O.HALF_FLOAT]=8,h),z=((p={})[A.RGBA]=4,p[A.RGB]=3,p[A.LUMINANCE]=1,p[A.LUMINANCE_ALPHA]=2,p[A.ALPHA]=1,p),Z=((v={})[O.UNSIGNED_SHORT_4_4_4_4]=2,v[O.UNSIGNED_SHORT_5_5_5_1]=2,v[O.UNSIGNED_SHORT_5_6_5]=2,v),$=function(){function _(){}return _.use=function(R,T){"ktx"===R.extension&&R.data&&_.parse(R.name||R.url,R.data),T()},_.parse=function(R,T){var e=new DataView(T);if(_.validate(R,e)){var E=67305985===e.getUint32(m,!0),G=e.getUint32(y,E),t=e.getUint32(g,E),O=e.getUint32(b,E),A=e.getUint32(V,E),D=e.getUint32(W,E)||1,M=e.getUint32(k,E)||1,r=e.getUint32(K,E)||1,I=e.getUint32(Q,E),n=e.getUint32(j,E),X=e.getUint32(J,E);if(0===D||1!==M)throw new Error("Only 2D textures are supported");if(1!==I)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==r)throw new Error("WebGL does not support array textures");var o,F=A+3&-4,a=D+3&-4,P=new Array(r),C=A*D;if(0===G&&(C=F*a),void 0===(o=0!==G?q[G]?q[G]*z[t]:Z[G]:S[O]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var s=C*o,N=A,u=D,f=F,U=a,L=64+X,l=0;l<n;l++){for(var c=e.getUint32(L,E),d=L+4,h=0;h<r;h++){var p=P[h];p||(p=P[h]=new Array(n)),p[l]={levelID:l,levelWidth:n>1?N:f,levelHeight:n>1?u:U,levelBuffer:new Uint8Array(T,d,s)},d+=s}L=(L+=c+4)%4!=0?L+4-L%4:L,s=(f=(N=N>>1||1)+4-1&-4)*(U=(u=u>>1||1)+4-1&-4)*o}if(0!==G)throw new Error("TODO: Uncompressed");i(R,P.map(function(_){return new B(null,{format:O,width:A,height:D,levels:n,levelBuffers:_})}))}},_.validate=function(_,R){for(var T=0;T<H.length;T++)if(R.getUint8(T)!==H[T])return console.error(_+" is not a valid *.ktx file!"),!1;return!0},_}();export{F as BlobResource,a as CompressedTextureLoader,B as CompressedTextureResource,x as DDSLoader,z as FORMATS_TO_COMPONENTS,M as INTERNAL_FORMATS,S as INTERNAL_FORMAT_TO_BYTES_PER_PIXEL,$ as KTXLoader,q as TYPES_TO_BYTES_PER_COMPONENT,Z as TYPES_TO_BYTES_PER_PIXEL};
//# sourceMappingURL=compressed-textures.min.js.map
